//Front-end for the web application vulnerability scanner

/*
  - Takes in a URL to a web application 
  - Sends POST request to middle layer
    - Responds with a POST response from the middle layer, which gets results from back-end
  - FUTURE IMPLEMENTATIONS: 
    - Account for users 
    - Basic information about vulnerabilities
    - Display suggestd code to secure different types of vulnereabilities
*/

import './App.css';
import React, { useState } from 'react';
import axios from 'axios';

const App = () => {
  const [url, SetUrl] = useState('');
  const [scanningResult, setScannedResult] = useState(null);
  const [loadingResult, setLoadingResult] = useState(false);

  const StartingScanning = () => {
    // Sends POST request to node.js and should receive response once completed
    setLoadingResult(true); 
    axios.post('api/startScanning', {url}).then(response => {
      setScannedResult(response.data); // Receive response here
      setLoadingResult(false);
    })
    // To catch any error that may occur from sending POST request
    .catch(error => {
      console.error("Error Sending request", error);
      setLoadingResult(false);
    });

  };
  
  return (
    <div className="App">
      <header className="App-header">
        <table>
          <tr>
            <th>Learn Vulnerabilities</th>
            <th>How this Website works</th>
            <th>Your Account</th>
          </tr>
        </table>
      </header>
      <form className="App-form">
        <label>
          Please paste web application link:
          <input type="text" value = {url} placeholder = "Paste in URL" onChange = {event => SetUrl(event.target.value)}/>
        </label>
        <button onClick = {StartingScanning} disabled = {loadingResult}>Start Scan</button>
        {loadingResult && <p>Loading Result...</p>}
        {scanningResult && (
          <div>
            <h1>
              Scanned Results
            </h1>
            <pre>
              {JSON.stringify(scanningResult, null, 2)}
            </pre>
          </div>
        )}
      </form>
    </div>
  );
};

export default App;
